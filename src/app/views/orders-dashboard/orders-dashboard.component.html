<section class="dashboard-container">
  <nav class="tab-navigation" aria-label="Dashboard views">
    <ul class="tab-list">
      <li>
        <button class="tab-button" [class.active]="activeTab === 'ordres'" (click)="setActiveTab('ordres')" role="tab"
          type="button">
          Ordres
        </button>
      </li>
      <li>
        <button class="tab-button" [class.active]="activeTab === 'menus'" (click)="setActiveTab('menus')" role="tab"
          type="button">
          Menus
        </button>
      </li>
      <li>
        <button class="tab-button" [class.active]="activeTab === 'usuaris'" (click)="setActiveTab('usuaris')" role="tab"
          type="button">
          Usuaris
        </button>
      </li>
    </ul>
  </nav>

  <div class="controls-container" *ngIf="activeTab !== 'json' && activeTab !== 'export'">
    <div class="date-selector">
      <button class="calendar-button" aria-label="Open calendar" type="button" (click)="dateInput?.focus()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M3 4H21V8H3V4Z" stroke="currentColor" stroke-width="2"></path>
          <path d="M4 8V20H20V8" stroke="currentColor" stroke-width="2"></path>
          <path d="M8 12H16" stroke="currentColor" stroke-width="2"></path>
        </svg>
      </button>
      <input #dateInput type="date" class="date-input" [value]="selectedDate" (change)="onDateChange($event)"
        aria-label="Selected date" />
    </div>

    <button class="export-button" aria-label="Export data" (click)="exportData()" type="button"
      *ngIf="activeTab === 'ordres'">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
        <path d="M4 16V17C4 18.7 5.3 20 7 20H17C18.7 20 20 18.7 20 17V16" stroke="white" stroke-width="2"></path>
        <path d="M12 4V16M12 16L8 12M12 16L16 12" stroke="white" stroke-width="2"></path>
      </svg>
      <span>Exportar</span>
    </button>
  </div>

  <div *ngIf="activeTab === 'ordres'" class="orders-container">
    <table class="orders-table">
      <thead>
        <tr>
          <th>User</th>
          <th>Email</th>
          <th>Order Date</th>
          <th>Type</th>
          <th>Status</th>
          <th>Allergies</th>
          <th>Primer plat</th>
          <th>Segon plat</th>
          <th>Postres</th>
          <th>Porta Tupper</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let order of orders">
          <td>{{ order.userData.name }} {{ order.userData.last_name }}</td>
          <td>{{ order.userData.email }}</td>
          <td>{{ order.order_date }}</td>
          <td>{{ order.orderType.name }}</td>
          <td>{{ order.orderStatus.name }}</td>
          <td>{{ order.allergies || "—" }}</td>
          <td>{{ order.orderDetail.option1 || "—" }}</td>
          <td>{{ order.orderDetail.option2 || "—" }}</td>
          <td>{{ order.orderDetail.option3 || "—" }}</td>
          <td>{{ order.has_tupper === 1 ? 'Sí' : 'No' }}</td>
        </tr>
        <tr *ngIf="orders.length === 0">
          <td colspan="8" class="empty-state">
            No orders found for {{ selectedDate }}.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="activeTab === 'menus'" class="menus-container">
    <table class="menus-table">
      <thead>
        <tr>
          <th>Tipus</th>
          <th>Plat</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let menu of menus">
          <td>{{ menu.type }}</td>
          <td>{{ menu.name }}</td>
        </tr>
        <tr *ngIf="menus.length === 0">
          <td colspan="2" class="empty-state">
            No hi han menus per la data seleccionada
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="activeTab === 'usuaris'">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Last Name</th>
          <th>Email</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let student of students">
          <td>{{ student.id }}</td>
          <td>{{ student.name }}</td>
          <td>{{ student.lastName }}</td>
          <td>{{ student.email }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="activeTab === 'json'">
    <p>JSON content here (to be implemented)</p>
  </div>
  <div *ngIf="activeTab === 'export'">
    <p>Export content here (to be implemented)</p>
  </div>
</section>